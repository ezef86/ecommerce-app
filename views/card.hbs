{{!-- Expects 'product' object and 'index' (0-based) as context --}}
<div class="card h-100 shadow-sm product-card" 
    data-product-id="{{product._id}}" 
    data-product-name="{{product.name}}" 
    data-product-price="{{product.price}}" 
    data-product-image="{{#if product.isbn}}https://covers.openlibrary.org/b/isbn/{{product.isbn}}-M.jpg{{else if product.imageUrl}}{{product.imageUrl}}{{else}}/assets/images/placeholder-book.png{{/if}}">

    {{!-- Image logic: prefer isbn, then imageUrl, then placeholder --}}
    {{#if product.isbn}}
        <img src="https://covers.openlibrary.org/b/isbn/{{product.isbn}}-M.jpg" class="card-img-top product-image" alt="{{product.name}}">
    {{else if product.imageUrl}}
        <img src="{{product.imageUrl}}" class="card-img-top product-image" alt="{{product.name}}">
    {{else}}
        <img src="/public/assets/images/imagen-no-disponible.png" class="card-img-top product-image" alt="{{product.name}}">
    {{/if}}
    
    <div class="card-body d-flex flex-column">
        <h5 class="card-title">{{product.name}}</h5>
        <p class="card-text flex-grow-1">{{product.description}}</p>
        <p class="card-text"><strong>Price:</strong> ${{product.price}}</p>
        <p class="card-text"><small class="text-muted">Stock: {{product.stock}}</small></p>
    </div>
    <div class="card-footer bg-transparent border-top-0">
        <button class="btn btn-primary w-100 add-to-cart-btn" 
                {{#if (eq product.stock 0)}}disabled{{/if}}>
            <i class="bi bi-cart-plus"></i> 
            {{#if (eq product.stock 0)}}No hay Stock{{else}}Agregar al Carrito{{/if}}
        </button>
    </div>
</div>